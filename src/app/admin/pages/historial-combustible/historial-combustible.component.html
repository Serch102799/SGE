<div class="usuarios-container">
  <div class="container-header">
    <h2>Historial de Cargas de Combustible</h2>
    <a routerLink="/admin/registro-carga-combustible" class="btn-agregar">
      <span>&#43;</span> Registrar Nueva Carga
    </a>
  </div>
  <div class="container-body">
    <div class="filtros-container">
      <div class="filtro-item">
        <input type="text" class="form-control" placeholder="Buscar por económico u operador..."
          [(ngModel)]="terminoBusqueda" (ngModelChange)="onSearchChange()">
      </div>
      <div class="filtro-item">
        <select class="form-control" [(ngModel)]="filtroRutaId" (change)="onSearchChange()">
          <option value="">Todas las Rutas</option>
          <option *ngFor="let ruta of rutas" [value]="ruta.id_ruta">{{ ruta.nombre_ruta }}</option>
        </select>
      </div>
    </div>
    <div class="contador-resultados">
        <strong>{{ totalItems }}</strong> cargas encontradas
    </div>
    <div class="tabla-responsive-wrapper">
      <table class="tabla-usuarios">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Autobús</th>
            <th>Operador</th>
            <th>KM Recorridos</th>
            <th>Litros</th>
            <th>Rendimiento (KM/L)</th>
            <th>Rutas y Vueltas</th>
            <th>Despachador</th>
          </tr>
        </thead>
        <tbody>
  <tr *ngFor="let carga of cargas | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage, totalItems: totalItems }">
    <td>{{ carga.fecha_operacion | date:'dd/MM/yy h:mm a' }}</td>
    <td>{{ carga.economico }}</td>
    <td>{{ carga.nombre_operador }}</td>
    <td>{{ carga.km_recorridos | number }} km</td>
    <td>{{ carga.litros_cargados | number:'1.2-2' }} Lts</td>
    <td>
      <span [ngClass]="{'alerta-rendimiento': carga.alerta_rendimiento}">
        {{ carga.rendimiento_calculado | number:'1.2-2' }}
      </span>
    </td>
    <td>{{ carga.rutas_info }}</td>
    <td>{{ carga.nombre_despachador }}</td>
  </tr>
  <tr *ngIf="cargas.length === 0">
    <td colspan="8" class="empty-table-message">No se encontraron cargas que coincidan con los filtros.</td>
  </tr>
</tbody>
      </table>
    </div>
    <div class="pagination-controls">
      <pagination-controls (pageChange)="onPageChange($event)" previousLabel="Anterior" nextLabel="Siguiente"></pagination-controls>
    </div>
  </div>
</div>